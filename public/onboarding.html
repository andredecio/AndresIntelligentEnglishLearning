<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Tell Us More About You</title>

  <!-- Global & Page-Specific Styles -->
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="onboarding.css" />
</head>
<body>
  <!-- 🔁 Injected popup content (from common.html) -->
  <div id="common-html-placeholder"></div>

  <h1>Help us personalize your experience!</h1>

  <form id="onboarding-form">
    <!-- User Details -->
    <label for="first-name">First Name:</label>
    <input type="text" id="first-name" placeholder="e.g., John" required />

    <label for="last-name">Last Name:</label>
    <input type="text" id="last-name" placeholder="e.g., Doe" required />

    <label for="dob">Date of Birth:</label>
    <input type="date" id="dob" required />

    <label for="native-language">Your native or preferred language:</label>
    <input type="text" id="native-language" placeholder="e.g., Japanese" required autocomplete="off" />

    <!-- Optional Email Sign-Up -->
    <div id="email-field-container" style="display: none;">
      <p><strong>Create a permanent account:</strong></p>
      <label for="email">Email Address:</label>
      <input type="email" id="email" placeholder="you@example.com" autocomplete="off" />

      <label for="password">Password:</label>
      <input type="password" id="password" placeholder="At least 6 characters" autocomplete="off" />
      <small>Provide email + password to save your progress!</small>
    </div>

    <!-- Gender -->
    <label>Sex/Gender:</label>
    <div class="radio-group">
      <input type="radio" id="sex-male" name="sex" value="male" required />
      <label for="sex-male">Male</label>
      <input type="radio" id="sex-female" name="sex" value="female" />
      <label for="sex-female">Female</label>
    </div>

    <!-- Learning Goal -->
    <label for="learning-goal">Your English learning goals:</label>
    <select id="learning-goal" required>
      <option value="">Select a goal</option>
      <option value="conversation">Improve conversation</option>
      <option value="grammar">Understand grammar</option>
      <option value="pronunciation">Improve pronunciation</option>
      <option value="vocabulary">Expand vocabulary</option>
      <option value="business">English for business</option>
      <option value="travel">English for travel</option>
      <option value="other">Other (see notes)</option>
    </select>

    <textarea id="other-goal-notes" placeholder="e.g., prepare for IELTS" style="display: none; margin-top: 10px;"></textarea>

    <button type="submit" id="startDemoButton">Start Demo Lesson</button>
  </form>

  <!-- Status Messages -->
  <div id="loading" style="display: none;">Saving your preferences...</div>
  <div id="error-message" class="error-message" style="display: none;"></div>

  <!-- Firebase SDKs (Compat) -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
  <script src="/__/firebase/init.js"></script>

  <!-- Load common popup HTML first -->
<script>
  fetch('common.html')
    .then(response => response.text())
    .then(html => {
      document.getElementById('common-html-placeholder').innerHTML = html;

      // Initialize popup functionality after HTML is inserted
      window.showError = function(message) {
        const popup = document.getElementById('popup');
        const popupMessage = document.getElementById('popup-message');
        const popupClose = document.getElementById('popup-close');

        if (!popup || !popupMessage || !popupClose) {
          console.warn('Popup element(s) not found.');
          return;
        }

        popupMessage.textContent = message;
        popup.style.display = 'block';

        popupClose.onclick = () => {
          popup.style.display = 'none';
        };

        setTimeout(() => {
          popup.style.display = 'none';
        }, 10000);
      };
    });
</script>


  <!-- Common logic (auth + popup display) -->
  <script src="common.js"></script>

  <!-- Page-specific logic -->
  <script src="onboarding.js"></script>
</body>
</html>
